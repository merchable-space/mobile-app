<ion-view view-title="All Products">
    <ion-content>
        <ion-refresher on-refresh="menuVm.getAllProducts()"
        pulling-text="Pull to refresh..."
        pulling-icon="ion-arrow-down-c"
        refreshing-text="Loading..."
        spinner="lines">
        </ion-refresher>

        <div class="card" ng-repeat="product in menuVm.productList">
            <ion-list>
                <ion-item class="item-divider">
                    {{product.name}}
                    <div class="item-hint">{{product.categories[0].name}}</div>
                </ion-item>
                <ion-item>
                    <img ng-src="{{product.images[0].src}}" style="width: 100%;" />
                </ion-item>
                <ion-item>
                    <table class="clear-table" ng-if="product.type === 'simple'">
                        <tr>
                            <td style="font-weight: 600;">
                                Price
                            </td>
                            <td style="text-align: right;">
                                {{product.price | number:2}}
                            </td>
                        </tr>
                        <tr>
                            <td style="font-weight: 600;">
                                Stock
                            </td>
                            <td style="text-align: right;">
                                {{product.stock_quantity}}
                            </td>
                        </tr>
                    </table>
                    <table class="clear-table" ng-if="product.type === 'variable'">
                        <tr style="font-weight: 600;border-bottom: 1px solid #888">
                            <td>
                                Variant
                            </td>
                            <td style="text-align: right;">
                                Price
                            </td>
                            <td style="text-align: right;">
                                Stock
                            </td>
                        </tr>
                        <tr ng-repeat="variant in menuVm.productVariants[product.id]" ng-class="{'amber-text' : variant.stock_quantity <= menuVm.userSettings['stockTrigger'], 'red-text semi-bold' : variant.stock_quantity == 0}">
                            <td>
                                {{variant.sku}}
                            </td>
                            <td style="text-align: right;">
                                {{variant.price | number:2}}
                            </td>
                            <td style="text-align: right;">
                                {{variant.stock_quantity}}
                            </td>
                        </tr>
                    </table>
                </ion-item>
                <ion-item class="item-divider item-icon-right" ng-click="menuVm.goToSingleStock(product.id)" ng-if="product.type === 'simple'">
                    Update Stock
                    <i class="icon typcn typcn-pencil"></i>
                </ion-item>
                <ion-item class="item-divider item-icon-right" ng-click="menuVm.goToVariantStock(product.id)" ng-if="product.type === 'variable'">
                    Update Stock
                    <i class="icon typcn typcn-pencil"></i>
                </ion-item>
            </ion-list>
        </div>
    </ion-content>
</ion-view>
